<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <title>Квиток</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- QR генератор (без сборки, работает в браузере) -->
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

  <style>
    body {
      margin: 0;
      padding: 0;
      background: #eef2f7;
      font-family: Arial, Helvetica, sans-serif;
    }

    .ticket {
      width: 320px;
      margin: 20px auto;
      background: #fff;
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.15);
    }

    .title {
      text-align: center;
      font-weight: 800;
      font-size: 16px;
      margin-bottom: 6px;
    }

    .subtitle {
      text-align: center;
      font-size: 13px;
      margin-bottom: 12px;
    }

    .row {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      margin-bottom: 4px;
    }

    .row b {
      font-weight: 700;
    }

    .sep {
      border-top: 1px dashed #cbd5e1;
      margin: 10px 0;
    }

    .qr-wrap {
      display: flex;
      justify-content: center;
      margin: 12px 0;
    }

    #qr {
      width: 200px;
      height: 200px;
    }

    .payload {
      font-size: 10px;
      color: #64748b;
      word-break: break-all;
      text-align: center;
      margin-top: 6px;
    }

    .footer {
      text-align: center;
      font-size: 11px;
      color: #475569;
      margin-top: 8px;
    }

    @media print {
      body {
        background: #fff;
      }
      .ticket {
        box-shadow: none;
        margin: 0;
      }
    }
  </style>
</head>
<body>

<div class="ticket">
  <div class="title">Театр ім. Шевченка</div>
  <div class="subtitle" id="event">Подія</div>

  <div class="row"><span>Дата</span><b id="date">—</b></div>
  <div class="row"><span>Час</span><b id="time">—</b></div>
  <div class="row"><span>Зона</span><b id="zone">—</b></div>
  <div class="row"><span>Ряд</span><b id="row">—</b></div>
  <div class="row"><span>Місце</span><b id="seat">—</b></div>
  <div class="row"><span>Ціна</span><b><span id="price">0</span> грн</b></div>

  <div class="sep"></div>

  <div class="qr-wrap">
    <div id="qr"></div>
  </div>

  <div class="payload" id="payloadText"></div>

  <div class="footer">
    Офлайн-каса • Vash Admin<br/>
    <span id="orderId"></span>
  </div>
</div>

<script>
  // --- helpers ---
  const qs = new URLSearchParams(location.search);
  const get = (k, d="") => qs.get(k) || d;

  // --- data ---
  const data = {
    event: get("event", "Подія"),
    date:  get("date",  "—"),
    time:  get("time",  "—"),
    zone:  get("zone",  "—"),
    row:   get("row",   "—"),
    seat:  get("seat",  "—"),
    price: get("price", "0"),
    order: get("order", "CASH-" + Date.now())
  };

  // --- fill text ---
  document.getElementById("event").textContent = data.event;
  document.getElementById("date").textContent  = data.date;
  document.getElementById("time").textContent  = data.time;
  document.getElementById("zone").textContent  = data.zone;
  document.getElementById("row").textContent   = data.row;
  document.getElementById("seat").textContent  = data.seat;
  document.getElementById("price").textContent = data.price;
  document.getElementById("orderId").textContent = data.order;

  // --- QR payload (ЭТО ВАЖНО) ---
  const qrPayload =
    `order:${data.order}` +
    `|event:${data.event}` +
    `|date:${data.date}` +
    `|time:${data.time}` +
    `|zone:${data.zone}` +
    `|row:${data.row}` +
    `|seat:${data.seat}` +
    `|price:${data.price}`;

  document.getElementById("payloadText").textContent = qrPayload;

  // --- generate QR ---
  new QRCode(document.getElementById("qr"), {
    text: qrPayload,
    width: 200,
    height: 200,
    correctLevel: QRCode.CorrectLevel.M
  });

  // авто-печать (если нужно — убери)
  // setTimeout(() => window.print(), 400);
</script>

</body>
</html>
