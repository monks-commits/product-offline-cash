<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <title>Квиток</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- QR -->
  <script src="https://unpkg.com/qrcodejs@1.0.0/qrcode.min.js"></script>

  <style>
    body {
      margin: 0;
      background: #f1f5f9;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
    }

    /* Размер ориентирован на 80мм термобумагу */
    .ticket {
      width: 320px;
      margin: 20px auto;
      background: #fff;
      padding: 14px 14px 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,.15);
      border-radius: 10px;
    }

    .theatre {
      text-align: center;
      font-weight: 900;
      font-size: 18px;
      margin-bottom: 4px;
    }

    .event {
      text-align: center;
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .line {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      margin: 2px 0;
    }

    .line b {
      font-weight: 700;
    }

    .sep {
      border-top: 1px dashed #cbd5e1;
      margin: 8px 0 10px;
    }

    .qr-wrap {
      display: flex;
      justify-content: center;
      margin: 10px 0 6px;
    }

    .qr {
      width: 220px;
      height: 220px;
    }

    .order {
      text-align: center;
      font-size: 11px;
      color: #475569;
      margin-top: 6px;
      word-break: break-all;
    }

    .foot {
      text-align: center;
      font-size: 11px;
      color: #64748b;
      margin-top: 6px;
    }
  </style>
</head>
<body>

<div class="ticket">
  <div class="theatre" id="tTheatre">Театр</div>
  <div class="event" id="tEvent">Подія</div>

  <div class="line"><span>Дата</span><b id="tDate">—</b></div>
  <div class="line"><span>Час</span><b id="tTime">—</b></div>
  <div class="line"><span>Зона</span><b id="tZone">—</b></div>
  <div class="line"><span>Ряд</span><b id="tRow">—</b></div>
  <div class="line"><span>Місце</span><b id="tSeat">—</b></div>
  <div class="line"><span>Ціна</span><b><span id="tPrice">—</span> грн</b></div>

  <div class="sep"></div>

  <div class="qr-wrap">
    <div id="qr" class="qr"></div>
  </div>

  <div class="order" id="tOrder">—</div>

  <div class="foot">
    Офлайн каса • Vash Admin
  </div>
</div>

<script>
  const p = new URLSearchParams(location.search);

  const data = {
    theatre: p.get("theatre") || "Театр ім. Шевченка",
    event:   p.get("event")   || "Подія",
    date:    p.get("date")    || "",
    time:    p.get("time")    || "",
    zone:    p.get("zone")    || "",
    row:     p.get("row")     || "",
    seat:    p.get("seat")    || "",
    price:   p.get("price")   || "",
    order:   p.get("order")   || ("CASH-" + Date.now())
  };

  // Текст
  tTheatre.textContent = data.theatre;
  tEvent.textContent   = data.event;
  tDate.textContent    = data.date;
  tTime.textContent    = data.time;
  tZone.textContent    = data.zone;
  tRow.textContent     = data.row;
  tSeat.textContent    = data.seat;
  tPrice.textContent   = data.price;
  tOrder.textContent   = data.order;

  // QR payload (важно: простой и стабильный)
  const qrPayload = [
    "order:" + data.order,
    "event:" + data.event,
    "date:" + data.date,
    "time:" + data.time,
    "zone:" + data.zone,
    "row:" + data.row,
    "seat:" + data.seat,
    "price:" + data.price
  ].join("|");

  new QRCode(document.getElementById("qr"), {
    text: qrPayload,
    width: 220,
    height: 220,
    correctLevel: QRCode.CorrectLevel.M
  });
</script>

</body>
</html>
