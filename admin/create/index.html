<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–°—Ç–≤–æ—Ä–µ–Ω–Ω—è / —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Å–µ–∞–Ω—Å—É</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="../styles.css">

<style>
.page-wrap{padding:20px;max-width:1200px;margin:auto}
.card{
  background:#fff;border-radius:14px;padding:16px;margin-bottom:16px;
  box-shadow:0 4px 14px rgba(0,0,0,.06);
}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
label{font-size:13px;color:#374151;display:flex;flex-direction:column}
input,select{
  padding:8px 10px;border-radius:8px;border:1px solid #d1d5db;
}
h1{margin-bottom:10px}
h3{margin:0 0 10px}
.btn{
  padding:10px 16px;border-radius:12px;border:none;
  font-weight:800;cursor:pointer
}
.btn-primary{background:#111827;color:#fff}
.btn-ghost{background:#f3f4f6}
.badge{
  padding:4px 10px;border-radius:999px;font-size:12px;
  background:#e5e7eb
}
.badge.ready{background:#bbf7d0}
.rule-list{
  margin-top:10px;font-size:14px
}
.rule{
  padding:6px 0;border-bottom:1px dashed #e5e7eb
}
pre{
  background:#020617;color:#e5e7eb;
  padding:12px;border-radius:10px;
  overflow:auto;font-size:13px
}
</style>
</head>

<body>

<div id="admin-header"></div>

<main class="page-wrap">
<h1>üõ† –°—Ç–≤–æ—Ä–µ–Ω–Ω—è / —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Å–µ–∞–Ω—Å—É</h1>

<!-- 1. –î–∞–Ω—ñ —Å–µ–∞–Ω—Å—É -->
<div class="card">
  <h3>1Ô∏è‚É£ –î–∞–Ω—ñ —Å–µ–∞–Ω—Å—É</h3>

  <div class="row">
    <label>
      –ü–æ–¥—ñ—è
      <select id="eventSlug">
        <option value="">‚Äî –≤–∏–±—Ä–∞—Ç–∏ ‚Äî</option>
        <option value="koncert">koncert</option>
        <option value="vistava">vistava</option>
      </select>
    </label>

    <label>
      –î–∞—Ç–∞
      <input type="date" id="eventDate">
    </label>

    <label>
      –ß–∞—Å
      <input type="time" id="eventTime">
    </label>

    <label>
      Seance ID
      <input type="text" id="seanceId" disabled>
    </label>

    <span id="statusBadge" class="badge">—á–µ—Ä–Ω–µ—Ç–∫–∞</span>
  </div>

  <div class="row" style="margin-top:10px">
    <label>
      –°—Ç–∞—Ç—É—Å
      <select id="seanceStatus">
        <option value="draft">–ß–µ—Ä–Ω–µ—Ç–∫–∞</option>
        <option value="ready">–ì–æ—Ç–æ–≤–∏–π</option>
      </select>
    </label>
  </div>
</div>

<!-- 2. –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–ª—É -->
<div class="card">
  <h3>2Ô∏è‚É£ –¶—ñ–Ω–∏ —Ç–∞ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞–ª—É</h3>

  <div class="row">
    <label>
      –°–µ–∫—Ç–æ—Ä
      <select id="ruleSector">
        <option value="parter">–ü–∞—Ä—Ç–µ—Ä</option>
        <option value="amfi">–ê–º—Ñ—ñ—Ç–µ–∞—Ç—Ä</option>
        <option value="balcon">–ë–∞–ª–∫–æ–Ω</option>
      </select>
    </label>

    <label>
      –†—è–¥ –≤—ñ–¥
      <input type="number" id="rowFrom" min="1">
    </label>

    <label>
      –†—è–¥ –¥–æ
      <input type="number" id="rowTo" min="1">
    </label>

    <label>
      –¶—ñ–Ω–∞
      <input type="number" id="price">
    </label>

    <button class="btn btn-primary" onclick="addRule()">–î–æ–¥–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª–æ</button>
  </div>

  <div class="rule-list" id="rules"></div>
</div>

<!-- 3. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è -->
<div class="card">
  <h3>3Ô∏è‚É£ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è</h3>

  <button class="btn btn-primary" onclick="saveSeance()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)</button>

  <pre id="output"></pre>
</div>

</main>

<script>
/* ========= STATE ========= */
const seance = {
  event:"",
  date:"",
  time:"",
  seance_id:"",
  status:"draft",
  pricing:[]
};

/* ========= HELPERS ========= */
function updateSeanceId(){
  if(!seance.event || !seance.date || !seance.time) return;
  const t = seance.time.replace(":","-");
  seance.seance_id = `${seance.event}-${seance.date}-${t}`;
  document.getElementById("seanceId").value = seance.seance_id;
}

function updateStatusUI(){
  const badge = document.getElementById("statusBadge");
  badge.textContent = seance.status === "ready" ? "–≥–æ—Ç–æ–≤–∏–π" : "—á–µ—Ä–Ω–µ—Ç–∫–∞";
  badge.classList.toggle("ready", seance.status === "ready");
}

/* ========= RULES ========= */
function addRule(){
  const rule = {
    sector: ruleSector.value,
    from: +rowFrom.value,
    to: +rowTo.value,
    price: +price.value
  };
  seance.pricing.push(rule);
  renderRules();
}

function renderRules(){
  rules.innerHTML = "";
  seance.pricing.forEach(r=>{
    const d = document.createElement("div");
    d.className="rule";
    d.textContent = `${r.sector}: —Ä—è–¥–∏ ${r.from}-${r.to}, ${r.price} –≥—Ä–Ω`;
    rules.appendChild(d);
  });
}

/* ========= SAVE ========= */
function saveSeance(){
  const json = JSON.stringify(seance,null,2);
  output.textContent = json;
  console.log("SEANCE:", seance);
  alert("–°–µ–∞–Ω—Å –ø—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ (–Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Äî –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É —Ñ–∞–π–ª)");
}

/* ========= EVENTS ========= */
eventSlug.onchange = e=>{seance.event=e.target.value;updateSeanceId();}
eventDate.onchange = e=>{seance.date=e.target.value;updateSeanceId();}
eventTime.onchange = e=>{seance.time=e.target.value;updateSeanceId();}
seanceStatus.onchange = e=>{seance.status=e.target.value;updateStatusUI();}

/* ========= HEADER ========= */
fetch("../index.html")
  .then(r=>r.text())
  .then(html=>admin-header.innerHTML=html);

updateStatusUI();
</script>

</body>
</html>
