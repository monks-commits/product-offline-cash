<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–ü–æ–¥—ñ—ó ‚Äî –±—ñ–ª–µ—Ç–Ω–∏–π –≤—ñ–¥–¥—ñ–ª</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
.page-wrap{padding:20px;max-width:100%}
.card{
  background:#fff;border-radius:14px;
  padding:16px;margin-bottom:16px;
  box-shadow:0 4px 14px rgba(0,0,0,.06);
}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
h1{margin-bottom:10px}
h3{margin:0 0 10px}
select{
  padding:8px 10px;
  border-radius:8px;
  border:1px solid #d1d5db;
  min-width:260px;
}
.badge{
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  background:#e5e7eb;
}
iframe{
  width:100%;
  height:80vh;
  border:1px solid #e5e7eb;
  border-radius:14px;
  background:#f9fafb;
}
.hint{font-size:13px;color:#6b7280}
</style>
</head>

<body>

<div id="admin-header"></div>

<main class="page-wrap">

  <h1>üéü –ü–æ–¥—ñ—ó</h1>

  <!-- 1. Select seance -->
  <div class="card">
    <h3>1Ô∏è‚É£ –ê–∫—Ç–∏–≤–Ω–∏–π —Å–µ–∞–Ω—Å</h3>

    <div class="row">
      <select id="seanceSelect">
        <option value="">–í–∏–±–µ—Ä–∏ —Å–µ–∞–Ω—Å‚Ä¶</option>
      </select>
      <span class="badge">—Ä–æ–±–æ—á–∏–π —Ä–µ–∂–∏–º</span>
    </div>

    <p class="hint">
      –ü–æ–∫–∞–∑—É—é—Ç—å—Å—è –ª–∏—à–µ <b>–≥–æ—Ç–æ–≤—ñ –¥–æ –ø—Ä–æ–¥–∞–∂—É</b> —Å–µ–∞–Ω—Å–∏ (status = ready).
    </p>
  </div>

  <!-- 2. Hall -->
  <div class="card">
    <h3>2Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂ –∫–≤–∏—Ç–∫—ñ–≤</h3>

    <iframe id="hallFrame" src="" title="–°—Ö–µ–º–∞ –∑–∞–ª—É"></iframe>

    <p class="hint" style="margin-top:10px">
      –°—Ö–µ–º–∞ –∑–∞–ª—É –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —É —Ä–µ–∂–∏–º—ñ <b>embed</b>.  
      –ü—Ä–æ–¥–∞–∂—ñ, –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —Ç–∞ –¥—Ä—É–∫ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —Ç—É—Ç.
    </p>
  </div>

</main>

<script>
/* ===== HEADER ===== */
fetch("../index.html")
  .then(r=>r.text())
  .then(html=>{
    document.getElementById("admin-header").innerHTML = html;
  });

const select = document.getElementById("seanceSelect");
const frame  = document.getElementById("hallFrame");

/* ===== LOAD READY SEANCES ===== */
async function loadSeances(){
  try{
    const res = await fetch("../../data/seances/index.json");
    const list = await res.json();

    list
      .filter(s => s.status === "ready")
      .forEach(s=>{
        const o = document.createElement("option");
        o.value = s.seance_id;
        o.textContent = `${s.event} ‚Ä¢ ${s.date} ‚Ä¢ ${s.time}`;
        select.appendChild(o);
      });

  }catch(e){
    console.error(e);
    alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Å–µ–∞–Ω—Å—ñ–≤");
  }
}

/* ===== ON SELECT ===== */
select.addEventListener("change", ()=>{
  const seanceId = select.value;
  if(!seanceId){
    frame.src = "";
    return;
  }

  frame.src =
    `../../hall/hall-cash.html?embed=1&seance=${encodeURIComponent(seanceId)}`;
});

loadSeances();
</script>

</body>
</html>
